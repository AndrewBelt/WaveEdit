
LOCAL = $(PWD)
export CFLAGS = -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.7.sdk \
	-mmacosx-version-min=10.7
export CXXFLAGS = $(CFLAGS)
export LDFLAGS = $(CFLAGS)

sdl2 = SDL2-2.0.5
jansson = jansson-2.10
libsndfile = libsndfile-1.0.28
libsamplerate = libsamplerate-0.1.9


.NOTPARALLEL:

all: $(sdl2) $(jansson) $(libsndfile) $(libsamplerate)

$(sdl2):
	wget -nc https://www.libsdl.org/release/$@.tar.gz
	tar xf $@.tar.gz
	cd $@ && ./configure --prefix=$(LOCAL)
	$(MAKE) -C $@
	$(MAKE) -C $@ install

$(jansson):
	wget -nc http://www.digip.org/jansson/releases/$@.tar.gz
	tar xf $@.tar.gz
	cd $@ && ./configure --prefix=$(LOCAL)
	$(MAKE) -C $@
	$(MAKE) -C $@ install

$(libsndfile):
	wget -nc http://www.mega-nerd.com/libsndfile/files/$@.tar.gz
	tar xf $@.tar.gz
	cd $@ && ./configure --prefix=$(LOCAL)
	$(MAKE) -C $@
	$(MAKE) -C $@ install

$(libsamplerate):
	wget -nc http://www.mega-nerd.com/SRC/$@.tar.gz
	tar xf $@.tar.gz
	cd $@ && ./configure --prefix=$(LOCAL)
	$(MAKE) -C $@
	$(MAKE) -C $@ install

clean:
	git clean -fdx